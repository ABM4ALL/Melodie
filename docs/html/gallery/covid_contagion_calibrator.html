

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CovidContagionCalibrator &mdash; Melodie 1.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=292eb321"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="RockPaperScissorsTrainer" href="rock_paper_scissors_trainer.html" />
    <link rel="prev" title="CovidContagionNetwork" href="covid_contagion_network.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            Melodie
              <img src="../_static/logo.jpg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#user-installation">User Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#developer-installation">Developer Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#dependency-note">Dependency Note</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#agent-based-model-abm">Agent-based Model (ABM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../introduction.html#melodie-framework">Melodie Framework</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../introduction.html#the-model">The Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction.html#the-scenario">The Scenario</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction.html#modelling-manager">Modelling Manager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../introduction.html#infrastructure">Infrastructure</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial.html">Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial.html#model">Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial.html#scenario">Scenario</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial.html#environment">Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial.html#agent">Agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial.html#data-collector">Data Collector</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial.html#run-the-model">Run the model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../framework_comparison.html">Framework Comparison</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../framework_comparison.html#project-structure">Project Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../framework_comparison.html#high-level-comparison">High-Level Comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="../framework_comparison.html#a-note-on-this-comparison">A Note on This Comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="../framework_comparison.html#advanced-features-in-melodie">Advanced Features in Melodie</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="_index.html">Model Gallery</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="covid_contagion_grid.html">CovidContagionGrid</a><ul>
<li class="toctree-l3"><a class="reference internal" href="covid_contagion_grid.html#grid-project-structure">Grid: Project Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="covid_contagion_grid.html#grid-key-changes">Grid: Key Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="covid_contagion_grid.html#grid-input-data">Grid: Input Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="covid_contagion_grid.html#grid-running-the-model">Grid: Running the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="covid_contagion_grid.html#grid-code">Grid: Code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="covid_contagion_grid.html#model">Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="covid_contagion_grid.html#environment">Environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="covid_contagion_grid.html#agent">Agent</a></li>
<li class="toctree-l4"><a class="reference internal" href="covid_contagion_grid.html#data-collector">Data Collector</a></li>
<li class="toctree-l4"><a class="reference internal" href="covid_contagion_grid.html#grid">Grid</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="covid_contagion_grid_visual.html">CovidContagionGridVisual</a><ul>
<li class="toctree-l3"><a class="reference internal" href="covid_contagion_grid_visual.html#visualizer-project-structure">Visualizer: Project Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="covid_contagion_grid_visual.html#visualizer-key-changes">Visualizer: Key Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="covid_contagion_grid_visual.html#visualizer-running-the-model">Visualizer: Running the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="covid_contagion_grid_visual.html#visualizer-code">Visualizer: Code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="covid_contagion_grid_visual.html#visualizer">Visualizer</a></li>
<li class="toctree-l4"><a class="reference internal" href="covid_contagion_grid_visual.html#model">Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="covid_contagion_grid_visual.html#environment">Environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="covid_contagion_grid_visual.html#agent">Agent</a></li>
<li class="toctree-l4"><a class="reference internal" href="covid_contagion_grid_visual.html#grid">Grid</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="covid_contagion_network.html">CovidContagionNetwork</a><ul>
<li class="toctree-l3"><a class="reference internal" href="covid_contagion_network.html#network-project-structure">Network: Project Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="covid_contagion_network.html#network-key-changes">Network: Key Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="covid_contagion_network.html#network-input-data">Network: Input Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="covid_contagion_network.html#network-running-the-model">Network: Running the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="covid_contagion_network.html#network-code">Network: Code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="covid_contagion_network.html#model">Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="covid_contagion_network.html#environment">Environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="covid_contagion_network.html#agent">Agent</a></li>
<li class="toctree-l4"><a class="reference internal" href="covid_contagion_network.html#scenario">Scenario</a></li>
<li class="toctree-l4"><a class="reference internal" href="covid_contagion_network.html#data-collector">Data Collector</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">CovidContagionCalibrator</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#calibrator-project-structure">Calibrator: Project Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calibrator-key-changes">Calibrator: Key Changes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calibrator-ga-concepts">Calibrator: GA Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calibrator-input-data">Calibrator: Input Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calibrator-running-the-model">Calibrator: Running the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calibrator-code">Calibrator: Code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#calibrator">Calibrator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#scenario">Scenario</a></li>
<li class="toctree-l4"><a class="reference internal" href="#model">Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#environment">Environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="#agent">Agent</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-collector">Data Collector</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="rock_paper_scissors_trainer.html">RockPaperScissorsTrainer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="rock_paper_scissors_trainer.html#trainer-project-structure">Trainer: Project Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="rock_paper_scissors_trainer.html#trainer-ga-concepts">Trainer: GA Concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="rock_paper_scissors_trainer.html#trainer-how-it-works">Trainer: How It Works</a></li>
<li class="toctree-l3"><a class="reference internal" href="rock_paper_scissors_trainer.html#trainer-results">Trainer: Results</a></li>
<li class="toctree-l3"><a class="reference internal" href="rock_paper_scissors_trainer.html#trainer-running-the-model">Trainer: Running the Model</a></li>
<li class="toctree-l3"><a class="reference internal" href="rock_paper_scissors_trainer.html#trainer-code">Trainer: Code</a><ul>
<li class="toctree-l4"><a class="reference internal" href="rock_paper_scissors_trainer.html#model">Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="rock_paper_scissors_trainer.html#environment">Environment</a></li>
<li class="toctree-l4"><a class="reference internal" href="rock_paper_scissors_trainer.html#agent">Agent</a></li>
<li class="toctree-l4"><a class="reference internal" href="rock_paper_scissors_trainer.html#data-collector">Data Collector</a></li>
<li class="toctree-l4"><a class="reference internal" href="rock_paper_scissors_trainer.html#scenario">Scenario</a></li>
<li class="toctree-l4"><a class="reference internal" href="rock_paper_scissors_trainer.html#trainer">Trainer</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api/simulator.html">Simulator</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/simulator.html#Melodie.Simulator"><code class="docutils literal notranslate"><span class="pre">Simulator</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/simulator.html#Melodie.Simulator.generate_scenarios"><code class="docutils literal notranslate"><span class="pre">Simulator.generate_scenarios()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/simulator.html#Melodie.Simulator.run_model"><code class="docutils literal notranslate"><span class="pre">Simulator.run_model()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/simulator.html#Melodie.Simulator.setup"><code class="docutils literal notranslate"><span class="pre">Simulator.setup()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/simulator.html#Melodie.Simulator.run"><code class="docutils literal notranslate"><span class="pre">Simulator.run()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/simulator.html#Melodie.Simulator.run_visual"><code class="docutils literal notranslate"><span class="pre">Simulator.run_visual()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/simulator.html#Melodie.Simulator.run_parallel"><code class="docutils literal notranslate"><span class="pre">Simulator.run_parallel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/simulator.html#Melodie.Simulator.new_parallel"><code class="docutils literal notranslate"><span class="pre">Simulator.new_parallel()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/model.html">Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/model.html#Melodie.Model"><code class="docutils literal notranslate"><span class="pre">Model</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/model.html#Melodie.Model.create"><code class="docutils literal notranslate"><span class="pre">Model.create()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/model.html#Melodie.Model.setup"><code class="docutils literal notranslate"><span class="pre">Model.setup()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/model.html#Melodie.Model.create_db_conn"><code class="docutils literal notranslate"><span class="pre">Model.create_db_conn()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/model.html#Melodie.Model.create_agent_list"><code class="docutils literal notranslate"><span class="pre">Model.create_agent_list()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/model.html#Melodie.Model.create_environment"><code class="docutils literal notranslate"><span class="pre">Model.create_environment()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/model.html#Melodie.Model.create_grid"><code class="docutils literal notranslate"><span class="pre">Model.create_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/model.html#Melodie.Model.create_network"><code class="docutils literal notranslate"><span class="pre">Model.create_network()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/model.html#Melodie.Model.create_data_collector"><code class="docutils literal notranslate"><span class="pre">Model.create_data_collector()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/model.html#Melodie.Model.create_agent_container"><code class="docutils literal notranslate"><span class="pre">Model.create_agent_container()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/model.html#Melodie.Model.run"><code class="docutils literal notranslate"><span class="pre">Model.run()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/model.html#Melodie.Model.iterator"><code class="docutils literal notranslate"><span class="pre">Model.iterator()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/model.html#Melodie.Model.init_visualize"><code class="docutils literal notranslate"><span class="pre">Model.init_visualize()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/scenario.html">Scenario</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/scenario.html#Melodie.Scenario"><code class="docutils literal notranslate"><span class="pre">Scenario</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/scenario.html#Melodie.Scenario.copy"><code class="docutils literal notranslate"><span class="pre">Scenario.copy()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/scenario.html#Melodie.Scenario.load_data"><code class="docutils literal notranslate"><span class="pre">Scenario.load_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/scenario.html#Melodie.Scenario.setup_data"><code class="docutils literal notranslate"><span class="pre">Scenario.setup_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/scenario.html#Melodie.Scenario.initialize"><code class="docutils literal notranslate"><span class="pre">Scenario.initialize()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/scenario.html#Melodie.Scenario.setup"><code class="docutils literal notranslate"><span class="pre">Scenario.setup()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/scenario.html#Melodie.Scenario.load_dataframe"><code class="docutils literal notranslate"><span class="pre">Scenario.load_dataframe()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/scenario.html#Melodie.Scenario.load_matrix"><code class="docutils literal notranslate"><span class="pre">Scenario.load_matrix()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/scenario.html#Melodie.Scenario.to_dict"><code class="docutils literal notranslate"><span class="pre">Scenario.to_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/scenario.html#Melodie.Scenario.to_json"><code class="docutils literal notranslate"><span class="pre">Scenario.to_json()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/scenario.html#Melodie.Scenario.get_dataframe"><code class="docutils literal notranslate"><span class="pre">Scenario.get_dataframe()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/scenario.html#Melodie.Scenario.get_matrix"><code class="docutils literal notranslate"><span class="pre">Scenario.get_matrix()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/environment.html">Environment</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/environment.html#Melodie.Environment"><code class="docutils literal notranslate"><span class="pre">Environment</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/environment.html#Melodie.Environment.setup"><code class="docutils literal notranslate"><span class="pre">Environment.setup()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/environment.html#Melodie.Environment.to_dict"><code class="docutils literal notranslate"><span class="pre">Environment.to_dict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/agent.html">Agent</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/agent.html#Melodie.Agent"><code class="docutils literal notranslate"><span class="pre">Agent</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/agent.html#Melodie.Agent.setup"><code class="docutils literal notranslate"><span class="pre">Agent.setup()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/agent_list.html">Agent List</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/agent_list.html#Melodie.AgentList"><code class="docutils literal notranslate"><span class="pre">AgentList</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/agent_list.html#Melodie.AgentList.setup_agents"><code class="docutils literal notranslate"><span class="pre">AgentList.setup_agents()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/agent_list.html#Melodie.AgentList.setup"><code class="docutils literal notranslate"><span class="pre">AgentList.setup()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/agent_list.html#Melodie.AgentList.init_agents"><code class="docutils literal notranslate"><span class="pre">AgentList.init_agents()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/agent_list.html#Melodie.AgentList.random_sample"><code class="docutils literal notranslate"><span class="pre">AgentList.random_sample()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/agent_list.html#Melodie.AgentList.filter"><code class="docutils literal notranslate"><span class="pre">AgentList.filter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/agent_list.html#Melodie.AgentList.add"><code class="docutils literal notranslate"><span class="pre">AgentList.add()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/agent_list.html#Melodie.AgentList.to_list"><code class="docutils literal notranslate"><span class="pre">AgentList.to_list()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/agent_list.html#Melodie.AgentList.to_dataframe"><code class="docutils literal notranslate"><span class="pre">AgentList.to_dataframe()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/agent_list.html#Melodie.AgentList.set_properties"><code class="docutils literal notranslate"><span class="pre">AgentList.set_properties()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/agent_list.html#Melodie.AgentList.get_agent"><code class="docutils literal notranslate"><span class="pre">AgentList.get_agent()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/agent_list.html#Melodie.AgentList.method_foreach"><code class="docutils literal notranslate"><span class="pre">AgentList.method_foreach()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/agent_list.html#Melodie.AgentList.vectorize"><code class="docutils literal notranslate"><span class="pre">AgentList.vectorize()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/agent_list.html#Melodie.AgentList.remove"><code class="docutils literal notranslate"><span class="pre">AgentList.remove()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/data_collector.html">Data Collector</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/data_collector.html#Melodie.DataCollector"><code class="docutils literal notranslate"><span class="pre">DataCollector</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/data_collector.html#Melodie.DataCollector.setup"><code class="docutils literal notranslate"><span class="pre">DataCollector.setup()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data_collector.html#Melodie.DataCollector.time_elapsed"><code class="docutils literal notranslate"><span class="pre">DataCollector.time_elapsed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data_collector.html#Melodie.DataCollector.add_agent_property"><code class="docutils literal notranslate"><span class="pre">DataCollector.add_agent_property()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data_collector.html#Melodie.DataCollector.add_environment_property"><code class="docutils literal notranslate"><span class="pre">DataCollector.add_environment_property()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data_collector.html#Melodie.DataCollector.add_custom_collector"><code class="docutils literal notranslate"><span class="pre">DataCollector.add_custom_collector()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data_collector.html#Melodie.DataCollector.env_property_names"><code class="docutils literal notranslate"><span class="pre">DataCollector.env_property_names()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data_collector.html#Melodie.DataCollector.agent_property_names"><code class="docutils literal notranslate"><span class="pre">DataCollector.agent_property_names()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data_collector.html#Melodie.DataCollector.agent_containers"><code class="docutils literal notranslate"><span class="pre">DataCollector.agent_containers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data_collector.html#Melodie.DataCollector.collect_agent_properties"><code class="docutils literal notranslate"><span class="pre">DataCollector.collect_agent_properties()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data_collector.html#Melodie.DataCollector.collect_custom_properties"><code class="docutils literal notranslate"><span class="pre">DataCollector.collect_custom_properties()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data_collector.html#Melodie.DataCollector.collect_single_custom_property"><code class="docutils literal notranslate"><span class="pre">DataCollector.collect_single_custom_property()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data_collector.html#Melodie.DataCollector.append_agent_properties_by_records"><code class="docutils literal notranslate"><span class="pre">DataCollector.append_agent_properties_by_records()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data_collector.html#Melodie.DataCollector.append_environment_properties"><code class="docutils literal notranslate"><span class="pre">DataCollector.append_environment_properties()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data_collector.html#Melodie.DataCollector.status"><code class="docutils literal notranslate"><span class="pre">DataCollector.status</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data_collector.html#Melodie.DataCollector.collect"><code class="docutils literal notranslate"><span class="pre">DataCollector.collect()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data_collector.html#Melodie.DataCollector.calc_time"><code class="docutils literal notranslate"><span class="pre">DataCollector.calc_time()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data_collector.html#Melodie.DataCollector.get_single_agent_data"><code class="docutils literal notranslate"><span class="pre">DataCollector.get_single_agent_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data_collector.html#Melodie.DataCollector.save"><code class="docutils literal notranslate"><span class="pre">DataCollector.save()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/data_collector.html#Melodie.DataCollector.save_dataframe"><code class="docutils literal notranslate"><span class="pre">DataCollector.save_dataframe()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/grid.html">Grid &amp; Spot</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/grid.html#Melodie.Grid"><code class="docutils literal notranslate"><span class="pre">Grid</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.init_grid"><code class="docutils literal notranslate"><span class="pre">Grid.init_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.setup_params"><code class="docutils literal notranslate"><span class="pre">Grid.setup_params()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.setup"><code class="docutils literal notranslate"><span class="pre">Grid.setup()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.add_category"><code class="docutils literal notranslate"><span class="pre">Grid.add_category()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.get_spot"><code class="docutils literal notranslate"><span class="pre">Grid.get_spot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.get_agent_ids"><code class="docutils literal notranslate"><span class="pre">Grid.get_agent_ids()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.coords_wrap"><code class="docutils literal notranslate"><span class="pre">Grid.coords_wrap()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.get_agent_neighborhood"><code class="docutils literal notranslate"><span class="pre">Grid.get_agent_neighborhood()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.get_spot_neighborhood"><code class="docutils literal notranslate"><span class="pre">Grid.get_spot_neighborhood()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.add_agent"><code class="docutils literal notranslate"><span class="pre">Grid.add_agent()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.remove_agent"><code class="docutils literal notranslate"><span class="pre">Grid.remove_agent()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.move_agent"><code class="docutils literal notranslate"><span class="pre">Grid.move_agent()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.get_agent_pos"><code class="docutils literal notranslate"><span class="pre">Grid.get_agent_pos()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.height"><code class="docutils literal notranslate"><span class="pre">Grid.height()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.width"><code class="docutils literal notranslate"><span class="pre">Grid.width()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.get_neighbors"><code class="docutils literal notranslate"><span class="pre">Grid.get_neighbors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.get_spot_agents"><code class="docutils literal notranslate"><span class="pre">Grid.get_spot_agents()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.get_colormap"><code class="docutils literal notranslate"><span class="pre">Grid.get_colormap()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.spots_to_json"><code class="docutils literal notranslate"><span class="pre">Grid.spots_to_json()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.get_empty_spots"><code class="docutils literal notranslate"><span class="pre">Grid.get_empty_spots()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.find_empty_spot"><code class="docutils literal notranslate"><span class="pre">Grid.find_empty_spot()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.setup_agent_locations"><code class="docutils literal notranslate"><span class="pre">Grid.setup_agent_locations()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.set_spot_property"><code class="docutils literal notranslate"><span class="pre">Grid.set_spot_property()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.rand_move_agent"><code class="docutils literal notranslate"><span class="pre">Grid.rand_move_agent()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.get_agent_container"><code class="docutils literal notranslate"><span class="pre">Grid.get_agent_container()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Grid.agent_categories"><code class="docutils literal notranslate"><span class="pre">Grid.agent_categories</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/grid.html#Melodie.Spot"><code class="docutils literal notranslate"><span class="pre">Spot</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Spot.get_spot_agents"><code class="docutils literal notranslate"><span class="pre">Spot.get_spot_agents()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/grid.html#Melodie.Spot.get_style"><code class="docutils literal notranslate"><span class="pre">Spot.get_style()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/network.html">Network &amp; Edge</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/network.html#Melodie.Network"><code class="docutils literal notranslate"><span class="pre">Network</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/network.html#Melodie.Network.setup"><code class="docutils literal notranslate"><span class="pre">Network.setup()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/network.html#Melodie.Network.add_edge"><code class="docutils literal notranslate"><span class="pre">Network.add_edge()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/network.html#Melodie.Network.get_edge"><code class="docutils literal notranslate"><span class="pre">Network.get_edge()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/network.html#Melodie.Network.remove_edge"><code class="docutils literal notranslate"><span class="pre">Network.remove_edge()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/network.html#Melodie.Network.get_neighbors"><code class="docutils literal notranslate"><span class="pre">Network.get_neighbors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/network.html#Melodie.Network.remove_agent"><code class="docutils literal notranslate"><span class="pre">Network.remove_agent()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/network.html#Melodie.Network.add_agent"><code class="docutils literal notranslate"><span class="pre">Network.add_agent()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/network.html#Melodie.Network.create_edge"><code class="docutils literal notranslate"><span class="pre">Network.create_edge()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/network.html#Melodie.Network.all_agents"><code class="docutils literal notranslate"><span class="pre">Network.all_agents()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/network.html#Melodie.Network.get_node_edges"><code class="docutils literal notranslate"><span class="pre">Network.get_node_edges()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/network.html#Melodie.Network.setup_layout_creator"><code class="docutils literal notranslate"><span class="pre">Network.setup_layout_creator()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/network.html#Melodie.Network.update_layout"><code class="docutils literal notranslate"><span class="pre">Network.update_layout()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/network.html#Melodie.Network.get_position"><code class="docutils literal notranslate"><span class="pre">Network.get_position()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/network.html#Melodie.Network.setup_agent_connections"><code class="docutils literal notranslate"><span class="pre">Network.setup_agent_connections()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/network.html#Melodie.Edge"><code class="docutils literal notranslate"><span class="pre">Edge</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/network.html#Melodie.Edge.setup"><code class="docutils literal notranslate"><span class="pre">Edge.setup()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/network.html#Melodie.Edge.post_setup"><code class="docutils literal notranslate"><span class="pre">Edge.post_setup()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/calibrator.html">Calibrator</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/calibrator.html#Melodie.Calibrator"><code class="docutils literal notranslate"><span class="pre">Calibrator</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/calibrator.html#Melodie.Calibrator.setup"><code class="docutils literal notranslate"><span class="pre">Calibrator.setup()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/calibrator.html#Melodie.Calibrator.collect_data"><code class="docutils literal notranslate"><span class="pre">Calibrator.collect_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/calibrator.html#Melodie.Calibrator.generate_scenarios"><code class="docutils literal notranslate"><span class="pre">Calibrator.generate_scenarios()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/calibrator.html#Melodie.Calibrator.get_params_scenarios"><code class="docutils literal notranslate"><span class="pre">Calibrator.get_params_scenarios()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/calibrator.html#Melodie.Calibrator.run"><code class="docutils literal notranslate"><span class="pre">Calibrator.run()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/calibrator.html#Melodie.Calibrator.run_once_new"><code class="docutils literal notranslate"><span class="pre">Calibrator.run_once_new()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/calibrator.html#Melodie.Calibrator.target_function"><code class="docutils literal notranslate"><span class="pre">Calibrator.target_function()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/calibrator.html#Melodie.Calibrator.distance"><code class="docutils literal notranslate"><span class="pre">Calibrator.distance()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/calibrator.html#Melodie.Calibrator.add_scenario_calibrating_property"><code class="docutils literal notranslate"><span class="pre">Calibrator.add_scenario_calibrating_property()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/calibrator.html#Melodie.Calibrator.add_environment_property"><code class="docutils literal notranslate"><span class="pre">Calibrator.add_environment_property()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api/trainer.html">Trainer</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/trainer.html#Melodie.Trainer"><code class="docutils literal notranslate"><span class="pre">Trainer</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/trainer.html#Melodie.Trainer.add_agent_training_property"><code class="docutils literal notranslate"><span class="pre">Trainer.add_agent_training_property()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trainer.html#Melodie.Trainer.setup"><code class="docutils literal notranslate"><span class="pre">Trainer.setup()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trainer.html#Melodie.Trainer.get_trainer_scenario_cls"><code class="docutils literal notranslate"><span class="pre">Trainer.get_trainer_scenario_cls()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trainer.html#Melodie.Trainer.collect_data"><code class="docutils literal notranslate"><span class="pre">Trainer.collect_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trainer.html#Melodie.Trainer.run"><code class="docutils literal notranslate"><span class="pre">Trainer.run()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trainer.html#Melodie.Trainer.run_once_new"><code class="docutils literal notranslate"><span class="pre">Trainer.run_once_new()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trainer.html#Melodie.Trainer.utility"><code class="docutils literal notranslate"><span class="pre">Trainer.utility()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trainer.html#Melodie.Trainer.target_function"><code class="docutils literal notranslate"><span class="pre">Trainer.target_function()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trainer.html#Melodie.Trainer.add_agent_property"><code class="docutils literal notranslate"><span class="pre">Trainer.add_agent_property()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trainer.html#Melodie.Trainer.add_environment_property"><code class="docutils literal notranslate"><span class="pre">Trainer.add_environment_property()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trainer.html#Melodie.Trainer.generate_scenarios"><code class="docutils literal notranslate"><span class="pre">Trainer.generate_scenarios()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/trainer.html#Melodie.Trainer.generate_trainer_params_list"><code class="docutils literal notranslate"><span class="pre">Trainer.generate_trainer_params_list()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contribution.html">Contribution</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../contribution.html#reporting-issues">Reporting Issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribution.html#contributing-code">Contributing Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contribution.html#adding-to-the-model-gallery">Adding to the Model Gallery</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Change Log</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../changelog.html#major-version-0-x">Major Version 0.x</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#v0-8-0-may-10-2023">v0.8.0 (May. 10, 2023)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#v0-7-0-mar-25-2023">v0.7.0 (Mar. 25, 2023)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#v0-6-0-jan-04-2023">v0.6.0 (Jan. 04, 2023)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#v0-5-0-dec-17-2022">v0.5.0 (Dec. 17, 2022)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#v0-4-2-dec-15-2022">v0.4.2 (Dec. 15, 2022)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#v0-4-1-dec-12-2022">v0.4.1 (Dec. 12, 2022)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#v0-4-0-nov-15-2022">v0.4.0 (Nov. 15, 2022)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#v0-3-0-oct-28-2022">v0.3.0 (Oct. 28, 2022)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#v0-2-0-oct-24-2022">v0.2.0 (Oct. 24, 2022)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#v0-1-1-aug-23-2022">v0.1.1 (Aug. 23, 2022)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#v0-1-0-jul-22-2022">v0.1.0 (Jul. 22, 2022)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../changelog.html#start-may-10-2021">Start (May. 10, 2021)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../about.html">About</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Melodie</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="_index.html">Model Gallery</a></li>
      <li class="breadcrumb-item active">CovidContagionCalibrator</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/gallery/covid_contagion_calibrator.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="covidcontagioncalibrator">
<span id="covid-contagion-calibrator"></span><h1>CovidContagionCalibrator<a class="headerlink" href="#covidcontagioncalibrator" title="Link to this heading"></a></h1>
<p>This example demonstrates how to use Melodie’s <strong>Calibrator</strong> module. It extends the base <code class="docutils literal notranslate"><span class="pre">covid_contagion</span></code> model by using a genetic algorithm (GA) to find the value of the <code class="docutils literal notranslate"><span class="pre">infection_prob</span></code> parameter that results in a target final infected ratio.</p>
<section id="calibrator-project-structure">
<h2>Calibrator: Project Structure<a class="headerlink" href="#calibrator-project-structure" title="Link to this heading"></a></h2>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>examples/covid_contagion_calibrator
│   ├── core/
│   │   ├── calibrator.py
│   │   ├── scenario.py
│   │   ├── data_collector.py
│   │   └── model.py
│   ├── data/
│   │   ├── CalibratorScenarios.csv
│   │   └── CalibratorParamsScenarios.csv
│   └── output/
└── main.py
</pre></div>
</div>
</section>
<section id="calibrator-key-changes">
<h2>Calibrator: Key Changes<a class="headerlink" href="#calibrator-key-changes" title="Link to this heading"></a></h2>
<p>The primary changes for the calibrator example are:</p>
<ul class="simple">
<li><p><strong>A ``calibrator.py`` Module</strong>: This new file defines the <code class="docutils literal notranslate"><span class="pre">CovidCalibrator</span></code> class, which inherits from <code class="docutils literal notranslate"><span class="pre">Melodie.Calibrator</span></code>.</p></li>
<li><p><strong>Calibrator Scenarios</strong>: The input data now includes <code class="docutils literal notranslate"><span class="pre">CalibratorScenarios.csv</span></code> and <code class="docutils literal notranslate"><span class="pre">CalibratorParamsScenarios.csv</span></code> to control the calibration process. <code class="docutils literal notranslate"><span class="pre">CalibratorScenarios.csv</span></code> is similar to <code class="docutils literal notranslate"><span class="pre">SimulatorScenarios</span></code> but does not use a <code class="docutils literal notranslate"><span class="pre">run_num</span></code> column.</p></li>
<li><p><strong>Path Modification in ``main.py``</strong>: A special modification to <code class="docutils literal notranslate"><span class="pre">sys.path</span></code> is included. This is necessary because the <code class="docutils literal notranslate"><span class="pre">Calibrator</span></code> uses multiprocessing for parallel execution. Worker processes are spawned in a new environment and need to be able to find and import the project’s modules (e.g., <cite>from examples.covid_contagion_calibrator.core…</cite>). This path modification is a robust way to ensure modules are discoverable when running examples directly from the Melodie repository, which is not a standard installed package.</p></li>
</ul>
</section>
<section id="calibrator-ga-concepts">
<h2>Calibrator: GA Concepts<a class="headerlink" href="#calibrator-ga-concepts" title="Link to this heading"></a></h2>
<p>The primary goal of the <code class="docutils literal notranslate"><span class="pre">Calibrator</span></code> is to automatically tune one or more model parameters to match observed, real-world data. It treats this as an optimization problem: finding the set of parameters that minimizes the “distance” between the model’s output and a specified target.</p>
<p><strong>Core Idea: Minimizing Distance</strong></p>
<ul class="simple">
<li><p><strong>Target</strong>: You define a target outcome. In this example, the target is for the final proportion of the population that has been infected to be 80%. This target is hard-coded in the <code class="docutils literal notranslate"><span class="pre">distance</span></code> function.</p></li>
<li><p><strong>Parameters</strong>: You specify which scenario parameter(s) the Calibrator should adjust. Here, it’s the <code class="docutils literal notranslate"><span class="pre">infection_prob</span></code>.</p></li>
<li><p><strong>Distance Function</strong>: You must implement a <code class="docutils literal notranslate"><span class="pre">distance(model)</span></code> method. This function is the core of the calibration. It runs after a simulation is complete, calculates a metric from the model’s final state, and returns a single float value representing how far off that metric is from the target. The Calibrator’s goal is to make this value as close to zero as possible.</p></li>
</ul>
<p><strong>Genetic Algorithm (GA) for Optimization</strong></p>
<p>Melodie uses a genetic algorithm to search the parameter space efficiently.</p>
<ul class="simple">
<li><p><strong>Chromosome</strong>: A single set of the parameters being calibrated (in this case, just a single value for <code class="docutils literal notranslate"><span class="pre">infection_prob</span></code>) is treated as a “chromosome.”</p></li>
<li><p><strong>Population</strong>: The GA starts with a “population” of these chromosomes, i.e., many different random values for <code class="docutils literal notranslate"><span class="pre">infection_prob</span></code>.</p></li>
<li><p><strong>Fitness</strong>: For each chromosome, the model is run, and the <code class="docutils literal notranslate"><span class="pre">distance</span></code> function is calculated. This distance is the fitness score (where lower is better).</p></li>
<li><p><strong>Evolution</strong>: The GA then proceeds through “generations.” In each generation, it selects the best-performing chromosomes (those that produced the smallest distance), “breeds” them (crossover), and introduces random changes (mutation) to create a new population of parameter sets to test. This process iteratively converges toward the parameter set that produces the best fit to the target.</p></li>
</ul>
<p id="ga-encoding-explanation"><strong>Parameter Encoding: From Float to Binary</strong></p>
<p>A key aspect of the genetic algorithm is how it represents continuous parameters like <code class="docutils literal notranslate"><span class="pre">infection_prob</span></code> (a float between 0.0 and 1.0). The GA does not work with the float values directly; instead, it converts them into a <strong>binary string</strong> of a fixed length. This process is called discretization.</p>
<ul class="simple">
<li><p><strong>Encoding</strong>: The range of a parameter (e.g., from <cite>infection_prob_min</cite> to <cite>infection_prob_max</cite>) is mapped to a sequence of integers, which are then represented as binary numbers. For instance, a float value is converted into a binary string like <code class="docutils literal notranslate"><span class="pre">01101</span></code>.</p></li>
<li><p><strong>GA Operations</strong>: All genetic operations, such as crossover (swapping parts of two binary strings) and mutation (flipping a random bit, e.g., <code class="docutils literal notranslate"><span class="pre">01101</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">01111</span></code>), are performed on these binary representations.</p></li>
<li><dl class="simple">
<dt><strong>Decoding</strong>: When a simulation needs to be run, the binary string is decoded back into its corresponding float value. This is done in three steps:</dt><dd><ol class="arabic simple">
<li><p>The binary string is converted to its decimal integer representation.</p></li>
<li><p>This integer is normalized to a float between 0.0 and 1.0 by dividing it by the maximum possible integer for that bit length (which is 2<sup>length</sup> - 1).</p></li>
<li><p>This normalized float is linearly mapped to the parameter’s defined range (e.g., from <cite>infection_prob_min</cite> to <cite>infection_prob_max</cite>).</p></li>
</ol>
</dd>
</dl>
</li>
<li><p><strong>Precision</strong>: The <code class="docutils literal notranslate"><span class="pre">strategy_param_code_length</span></code> parameter in the <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file determines the length of this binary string. A longer string allows for a more fine-grained representation of the parameter space (more steps between the min and max bounds), thus offering higher precision at the cost of a larger search space.</p></li>
</ul>
<p><strong>Parameter Configuration (`CalibratorParamsScenarios.csv`)</strong></p>
<p>This file controls the behavior of the genetic algorithm:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">id</span></code>: Unique identifier for a set of GA parameters.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">path_num</span></code>: How many independent calibration processes (paths) to run. Each path is a complete run of the GA from a random start, which helps ensure the result is robust and not just a local minimum.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">generation_num</span></code>: The number of generations the GA will run for in each path.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">strategy_population</span></code>: The size of the population in each generation (how many different parameter sets are tested).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mutation_prob</span></code>: The probability of a random mutation occurring during breeding.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">strategy_param_code_length</span></code>: The precision of the parameters, defined by the bit-length of the chromosome.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">infection_prob_min</span></code>, <code class="docutils literal notranslate"><span class="pre">infection_prob_max</span></code>: The lower and upper bounds for the <code class="docutils literal notranslate"><span class="pre">infection_prob</span></code> parameter search space.</p></li>
</ul>
</section>
<section id="calibrator-input-data">
<h2>Calibrator: Input Data<a class="headerlink" href="#calibrator-input-data" title="Link to this heading"></a></h2>
<p>In this example, the <code class="docutils literal notranslate"><span class="pre">distance</span></code> is calculated based on the model’s state at the <strong>end of the simulation</strong>. If you need to use data from all periods to calculate the target metric, you can compute and store the required value in an environment property throughout the simulation, ensuring it holds the final desired value at the last period.</p>
</section>
<section id="calibrator-running-the-model">
<h2>Calibrator: Running the Model<a class="headerlink" href="#calibrator-running-the-model" title="Link to this heading"></a></h2>
<p>You can run the calibrator using the main script:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>examples/covid_contagion_calibrator/main.py
</pre></div>
</div>
<p>This will execute the genetic algorithm, running multiple simulations in parallel to find the optimal <code class="docutils literal notranslate"><span class="pre">infection_prob</span></code>. The results, including the progression of parameters and distances across generations, are saved to the <code class="docutils literal notranslate"><span class="pre">data/output</span></code> folder.</p>
</section>
<section id="calibrator-code">
<h2>Calibrator: Code<a class="headerlink" href="#calibrator-code" title="Link to this heading"></a></h2>
<p>This section shows the key code implementation for the calibrator model. Files that are identical to the base <code class="docutils literal notranslate"><span class="pre">covid_contagion</span></code> model are noted.</p>
<section id="calibrator">
<h3>Calibrator<a class="headerlink" href="#calibrator" title="Link to this heading"></a></h3>
<p>Defined in <code class="docutils literal notranslate"><span class="pre">core/calibrator.py</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="linenos"> 2</span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">List</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="linenos"> 5</span><span class="kn">from</span><span class="w"> </span><span class="nn">Melodie</span><span class="w"> </span><span class="kn">import</span> <span class="n">Calibrator</span>
<span class="linenos"> 6</span>
<span class="linenos"> 7</span><span class="kn">from</span><span class="w"> </span><span class="nn">examples.covid_contagion_calibrator.core.model</span><span class="w"> </span><span class="kn">import</span> <span class="n">CovidModel</span>
<span class="linenos"> 8</span><span class="kn">from</span><span class="w"> </span><span class="nn">examples.covid_contagion_calibrator.core.scenario</span><span class="w"> </span><span class="kn">import</span> <span class="n">CovidScenario</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span>
<span class="linenos">11</span><span class="k">class</span><span class="w"> </span><span class="nc">CovidCalibrator</span><span class="p">(</span><span class="n">Calibrator</span><span class="p">):</span>
<span class="linenos">12</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">13</span><span class="sd">    Simple calibrator that tunes `infection_prob` so the final infected ratio matches a target.</span>
<span class="linenos">14</span><span class="sd">    </span>
<span class="linenos">15</span><span class="sd">    In this example, the target infected ratio is hardcoded to 0.8 inside the `distance` method.</span>
<span class="linenos">16</span><span class="sd">    The calibrator minimizes the squared difference between the actual infected ratio and this target.</span>
<span class="linenos">17</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">18</span>
<span class="linenos">19</span>    <span class="n">scenario_cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">CovidScenario</span><span class="p">]</span>
<span class="linenos">20</span>    <span class="n">model_cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">CovidModel</span><span class="p">]</span>
<span class="linenos">21</span>
<span class="linenos">22</span>    <span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">23</span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">24</span><span class="sd">        Setup the calibrator by defining which properties to tune and which to record.</span>
<span class="linenos">25</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">26</span>        <span class="c1"># Calibrate the `infection_prob` parameter in the scenario.</span>
<span class="linenos">27</span>        <span class="c1"># This tells the Genetic Algorithm (GA) to optimize this specific attribute.</span>
<span class="linenos">28</span>        <span class="bp">self</span><span class="o">.</span><span class="n">add_scenario_calibrating_property</span><span class="p">(</span><span class="s2">&quot;infection_prob&quot;</span><span class="p">)</span>
<span class="linenos">29</span>        
<span class="linenos">30</span>        <span class="c1"># Record environment-level data for analysis.</span>
<span class="linenos">31</span>        <span class="c1"># &#39;num_susceptible&#39; will be recorded in `Result_Calibrator_Environment.csv`</span>
<span class="linenos">32</span>        <span class="c1"># allowing us to verify the calibration result.</span>
<span class="linenos">33</span>        <span class="bp">self</span><span class="o">.</span><span class="n">add_environment_property</span><span class="p">(</span><span class="s2">&quot;num_susceptible&quot;</span><span class="p">)</span>
<span class="linenos">34</span>
<span class="linenos">35</span>    <span class="k">def</span><span class="w"> </span><span class="nf">distance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">CovidModel</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="linenos">36</span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">37</span><span class="sd">        Calculates the distance (error) between the model&#39;s result and the target.</span>
<span class="linenos">38</span><span class="sd">        The GA minimizes this value.</span>
<span class="linenos">39</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">40</span>        <span class="n">env</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">environment</span>
<span class="linenos">41</span>        
<span class="linenos">42</span>        <span class="c1"># Calculate the ratio of agents who were infected (including recovered)</span>
<span class="linenos">43</span>        <span class="c1"># 1 - (susceptible / total)</span>
<span class="linenos">44</span>        <span class="n">infected_ratio</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">env</span><span class="o">.</span><span class="n">num_susceptible</span> <span class="o">/</span> <span class="n">env</span><span class="o">.</span><span class="n">scenario</span><span class="o">.</span><span class="n">agent_num</span>
<span class="linenos">45</span>        
<span class="linenos">46</span>        <span class="c1"># Return squared error. </span>
<span class="linenos">47</span>        <span class="c1"># Target is hardcoded as 0.8 (80% infection rate).</span>
<span class="linenos">48</span>        <span class="k">return</span> <span class="p">(</span><span class="n">infected_ratio</span> <span class="o">-</span> <span class="mf">0.8</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="linenos">49</span>
</pre></div>
</div>
</section>
<section id="scenario">
<h3>Scenario<a class="headerlink" href="#scenario" title="Link to this heading"></a></h3>
<p>Defined in <code class="docutils literal notranslate"><span class="pre">core/scenario.py</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span><span class="w"> </span><span class="nn">Melodie</span><span class="w"> </span><span class="kn">import</span> <span class="n">Scenario</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="k">class</span><span class="w"> </span><span class="nc">CovidScenario</span><span class="p">(</span><span class="n">Scenario</span><span class="p">):</span>
<span class="linenos"> 5</span><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 6</span><span class="sd">    Defines the parameters for each simulation run of the virus contagion model.</span>
<span class="linenos"> 7</span><span class="sd">    It inherits from the base `Melodie.Scenario`.</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="sd">    Special Melodie attributes (automatically populated from `SimulatorScenarios`):</span>
<span class="linenos">10</span><span class="sd">    - `id`: A unique identifier for the scenario.</span>
<span class="linenos">11</span><span class="sd">    - `run_num`: How many times to repeat this scenario (for stochastic models). Defaults to 1.</span>
<span class="linenos">12</span><span class="sd">    - `period_num`: How many simulation steps (periods) for each run. Defaults to 0.</span>
<span class="linenos">13</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">14</span>
<span class="linenos">15</span>    <span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">16</span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">17</span><span class="sd">        Declares custom scenario parameters for type hinting and clarity.</span>
<span class="linenos">18</span><span class="sd">        These are automatically populated from columns in `SimulatorScenarios`.</span>
<span class="linenos">19</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">20</span>        <span class="bp">self</span><span class="o">.</span><span class="n">agent_num</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">21</span>        <span class="bp">self</span><span class="o">.</span><span class="n">initial_infected_percentage</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">22</span>        <span class="bp">self</span><span class="o">.</span><span class="n">infection_prob</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">23</span>        <span class="bp">self</span><span class="o">.</span><span class="n">recovery_prob</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">24</span>
<span class="linenos">25</span>    <span class="k">def</span><span class="w"> </span><span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">26</span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">27</span><span class="sd">        This method is automatically called by Melodie after scenario parameters are set.</span>
<span class="linenos">28</span><span class="sd">        It is the recommended place to load all static input dataframes, making them</span>
<span class="linenos">29</span><span class="sd">        accessible via `self.scenario.*` from `Model`, `Agent`, and `Environment`.</span>
<span class="linenos">30</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">31</span>        <span class="bp">self</span><span class="o">.</span><span class="n">health_states</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_dataframe</span><span class="p">(</span><span class="s2">&quot;ID_HealthState.csv&quot;</span><span class="p">)</span>
<span class="linenos">32</span>        <span class="c1"># Load the GA parameters configuration from &#39;CalibratorParamsScenarios.csv&#39;.</span>
<span class="linenos">33</span>        <span class="c1"># This file defines bounds (min/max) for parameters like &#39;infection_prob&#39;.</span>
<span class="linenos">34</span>        <span class="bp">self</span><span class="o">.</span><span class="n">calibrator_params_scenarios</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_dataframe</span><span class="p">(</span><span class="s2">&quot;CalibratorParamsScenarios.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="model">
<h3>Model<a class="headerlink" href="#model" title="Link to this heading"></a></h3>
<p><em>Identical to the base model.</em> Defined in <code class="docutils literal notranslate"><span class="pre">core/model.py</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="kn">from</span><span class="w"> </span><span class="nn">Melodie</span><span class="w"> </span><span class="kn">import</span> <span class="n">Model</span>
<span class="linenos"> 4</span><span class="kn">from</span><span class="w"> </span><span class="nn">.agent</span><span class="w"> </span><span class="kn">import</span> <span class="n">CovidAgent</span>
<span class="linenos"> 5</span><span class="kn">from</span><span class="w"> </span><span class="nn">.environment</span><span class="w"> </span><span class="kn">import</span> <span class="n">CovidEnvironment</span>
<span class="linenos"> 6</span><span class="kn">from</span><span class="w"> </span><span class="nn">.data_collector</span><span class="w"> </span><span class="kn">import</span> <span class="n">CovidDataCollector</span>
<span class="linenos"> 7</span><span class="kn">from</span><span class="w"> </span><span class="nn">.scenario</span><span class="w"> </span><span class="kn">import</span> <span class="n">CovidScenario</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
<span class="linenos">10</span>    <span class="kn">from</span><span class="w"> </span><span class="nn">Melodie</span><span class="w"> </span><span class="kn">import</span> <span class="n">AgentList</span>
<span class="linenos">11</span>
<span class="linenos">12</span>
<span class="linenos">13</span><span class="k">class</span><span class="w"> </span><span class="nc">CovidModel</span><span class="p">(</span><span class="n">Model</span><span class="p">):</span>
<span class="linenos">14</span>    <span class="n">scenario</span><span class="p">:</span> <span class="s2">&quot;CovidScenario&quot;</span>
<span class="linenos">15</span>    <span class="n">agents</span><span class="p">:</span> <span class="s2">&quot;AgentList[CovidAgent]&quot;</span>
<span class="linenos">16</span>    <span class="n">environment</span><span class="p">:</span> <span class="n">CovidEnvironment</span>
<span class="linenos">17</span>    <span class="n">data_collector</span><span class="p">:</span> <span class="n">CovidDataCollector</span>
<span class="linenos">18</span>
<span class="linenos">19</span>    <span class="k">def</span><span class="w"> </span><span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">20</span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">21</span><span class="sd">        This method is called once at the beginning of the simulation</span>
<span class="linenos">22</span><span class="sd">        to create the core components of the model.</span>
<span class="linenos">23</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">24</span>        <span class="bp">self</span><span class="o">.</span><span class="n">agents</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_agent_list</span><span class="p">(</span><span class="n">CovidAgent</span><span class="p">)</span>
<span class="linenos">25</span>        <span class="bp">self</span><span class="o">.</span><span class="n">environment</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_environment</span><span class="p">(</span><span class="n">CovidEnvironment</span><span class="p">)</span>
<span class="linenos">26</span>        <span class="bp">self</span><span class="o">.</span><span class="n">data_collector</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_data_collector</span><span class="p">(</span><span class="n">CovidDataCollector</span><span class="p">)</span>
<span class="linenos">27</span>
<span class="linenos">28</span>    <span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">29</span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">30</span><span class="sd">        This method is called once after `create` to set up the initial state</span>
<span class="linenos">31</span><span class="sd">        of the model components.</span>
<span class="linenos">32</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">33</span>        <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="o">.</span><span class="n">setup_agents</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scenario</span><span class="o">.</span><span class="n">agent_num</span><span class="p">)</span>
<span class="linenos">34</span>        <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">setup_infection</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">)</span>
<span class="linenos">35</span>
<span class="linenos">36</span>    <span class="k">def</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">37</span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">38</span><span class="sd">        This method defines the main simulation loop that runs for `scenario.period_num` periods.</span>
<span class="linenos">39</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">40</span>        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterator</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scenario</span><span class="o">.</span><span class="n">period_num</span><span class="p">):</span>
<span class="linenos">41</span>            <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">agents_interaction</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">)</span>
<span class="linenos">42</span>            <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">agents_recover</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">)</span>
<span class="linenos">43</span>            <span class="bp">self</span><span class="o">.</span><span class="n">environment</span><span class="o">.</span><span class="n">update_population_stats</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">)</span>
<span class="linenos">44</span>            <span class="bp">self</span><span class="o">.</span><span class="n">data_collector</span><span class="o">.</span><span class="n">collect</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
<span class="linenos">45</span>        <span class="bp">self</span><span class="o">.</span><span class="n">data_collector</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="environment">
<h3>Environment<a class="headerlink" href="#environment" title="Link to this heading"></a></h3>
<p><em>Identical to the base model.</em> Defined in <code class="docutils literal notranslate"><span class="pre">core/environment.py</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="linenos"> 2</span><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">TYPE_CHECKING</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="kn">from</span><span class="w"> </span><span class="nn">Melodie</span><span class="w"> </span><span class="kn">import</span> <span class="n">Environment</span>
<span class="linenos"> 5</span><span class="kn">from</span><span class="w"> </span><span class="nn">.agent</span><span class="w"> </span><span class="kn">import</span> <span class="n">CovidAgent</span>
<span class="linenos"> 6</span><span class="kn">from</span><span class="w"> </span><span class="nn">.scenario</span><span class="w"> </span><span class="kn">import</span> <span class="n">CovidScenario</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="k">if</span> <span class="n">TYPE_CHECKING</span><span class="p">:</span>
<span class="linenos"> 9</span>    <span class="kn">from</span><span class="w"> </span><span class="nn">Melodie</span><span class="w"> </span><span class="kn">import</span> <span class="n">AgentList</span>
<span class="linenos">10</span>
<span class="linenos">11</span>
<span class="linenos">12</span><span class="k">class</span><span class="w"> </span><span class="nc">CovidEnvironment</span><span class="p">(</span><span class="n">Environment</span><span class="p">):</span>
<span class="linenos">13</span>    <span class="n">scenario</span><span class="p">:</span> <span class="s2">&quot;CovidScenario&quot;</span>
<span class="linenos">14</span>
<span class="linenos">15</span>    <span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">16</span>        <span class="c1"># Macro-level counters for population statistics.</span>
<span class="linenos">17</span>        <span class="c1"># These are updated each period by `update_population_stats` and recorded by the DataCollector.</span>
<span class="linenos">18</span>        <span class="bp">self</span><span class="o">.</span><span class="n">num_susceptible</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">19</span>        <span class="bp">self</span><span class="o">.</span><span class="n">num_infected</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">20</span>        <span class="bp">self</span><span class="o">.</span><span class="n">num_recovered</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">21</span>
<span class="linenos">22</span>    <span class="k">def</span><span class="w"> </span><span class="nf">setup_infection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agents</span><span class="p">:</span> <span class="s2">&quot;AgentList[CovidAgent]&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">23</span>        <span class="c1"># Sets the initial percentage of infected agents based on scenario parameters.</span>
<span class="linenos">24</span>        <span class="k">for</span> <span class="n">agent</span> <span class="ow">in</span> <span class="n">agents</span><span class="p">:</span>
<span class="linenos">25</span>            <span class="k">if</span> <span class="p">(</span>
<span class="linenos">26</span>                <span class="n">agent</span><span class="o">.</span><span class="n">health_state</span> <span class="o">==</span> <span class="mi">0</span>
<span class="linenos">27</span>                <span class="ow">and</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">scenario</span><span class="o">.</span><span class="n">initial_infected_percentage</span>
<span class="linenos">28</span>            <span class="p">):</span>
<span class="linenos">29</span>                <span class="n">agent</span><span class="o">.</span><span class="n">health_state</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos">30</span>
<span class="linenos">31</span>    <span class="k">def</span><span class="w"> </span><span class="nf">agents_interaction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agents</span><span class="p">:</span> <span class="s2">&quot;AgentList[CovidAgent]&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">32</span>        <span class="c1"># Simulates random interactions where infected agents can spread the virus.</span>
<span class="linenos">33</span>        <span class="k">for</span> <span class="n">agent</span> <span class="ow">in</span> <span class="n">agents</span><span class="p">:</span>
<span class="linenos">34</span>            <span class="k">if</span> <span class="n">agent</span><span class="o">.</span><span class="n">health_state</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="linenos">35</span>                <span class="c1"># Randomly meet another agent</span>
<span class="linenos">36</span>                <span class="c1"># Note: Melodie&#39;s AgentList.random_sample returns a list</span>
<span class="linenos">37</span>                <span class="n">other_agent</span> <span class="o">=</span> <span class="n">agents</span><span class="o">.</span><span class="n">random_sample</span><span class="p">(</span><span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="linenos">38</span>                <span class="k">if</span> <span class="n">other_agent</span><span class="o">.</span><span class="n">health_state</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos">39</span>                    <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">scenario</span><span class="o">.</span><span class="n">infection_prob</span><span class="p">:</span>
<span class="linenos">40</span>                        <span class="n">other_agent</span><span class="o">.</span><span class="n">health_state</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos">41</span>    
<span class="linenos">42</span>    <span class="k">def</span><span class="w"> </span><span class="nf">agents_recover</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agents</span><span class="p">:</span> <span class="s2">&quot;AgentList[CovidAgent]&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">43</span>        <span class="c1"># Triggers the recovery process for all infected agents.</span>
<span class="linenos">44</span>        <span class="k">for</span> <span class="n">agent</span> <span class="ow">in</span> <span class="n">agents</span><span class="p">:</span>
<span class="linenos">45</span>            <span class="n">agent</span><span class="o">.</span><span class="n">health_state_update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scenario</span><span class="o">.</span><span class="n">recovery_prob</span><span class="p">)</span>
<span class="linenos">46</span>
<span class="linenos">47</span>    <span class="k">def</span><span class="w"> </span><span class="nf">update_population_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">agents</span><span class="p">:</span> <span class="s2">&quot;AgentList[CovidAgent]&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">48</span>        <span class="c1"># Aggregates agent states into environment-level population counts.</span>
<span class="linenos">49</span>        <span class="bp">self</span><span class="o">.</span><span class="n">num_susceptible</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">50</span>        <span class="bp">self</span><span class="o">.</span><span class="n">num_infected</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">51</span>        <span class="bp">self</span><span class="o">.</span><span class="n">num_recovered</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">52</span>
<span class="linenos">53</span>        <span class="k">for</span> <span class="n">agent</span> <span class="ow">in</span> <span class="n">agents</span><span class="p">:</span>
<span class="linenos">54</span>            <span class="k">if</span> <span class="n">agent</span><span class="o">.</span><span class="n">health_state</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos">55</span>                <span class="bp">self</span><span class="o">.</span><span class="n">num_susceptible</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="linenos">56</span>            <span class="k">elif</span> <span class="n">agent</span><span class="o">.</span><span class="n">health_state</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
<span class="linenos">57</span>                <span class="bp">self</span><span class="o">.</span><span class="n">num_infected</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="linenos">58</span>            <span class="k">elif</span> <span class="n">agent</span><span class="o">.</span><span class="n">health_state</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
<span class="linenos">59</span>                <span class="bp">self</span><span class="o">.</span><span class="n">num_recovered</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</section>
<section id="agent">
<h3>Agent<a class="headerlink" href="#agent" title="Link to this heading"></a></h3>
<p><em>Identical to the base model.</em> Defined in <code class="docutils literal notranslate"><span class="pre">core/agent.py</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="linenos"> 2</span><span class="kn">from</span><span class="w"> </span><span class="nn">Melodie</span><span class="w"> </span><span class="kn">import</span> <span class="n">Agent</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="k">class</span><span class="w"> </span><span class="nc">CovidAgent</span><span class="p">(</span><span class="n">Agent</span><span class="p">):</span>
<span class="linenos"> 6</span>    <span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 7</span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 8</span><span class="sd">        Initializes the agent&#39;s state.</span>
<span class="linenos"> 9</span><span class="sd">        `health_state`: 0 = susceptible, 1 = infected, 2 = recovered.</span>
<span class="linenos">10</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">11</span>        <span class="bp">self</span><span class="o">.</span><span class="n">health_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># All agents start as susceptible.</span>
<span class="linenos">12</span>
<span class="linenos">13</span>    <span class="k">def</span><span class="w"> </span><span class="nf">health_state_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">recovery_prob</span><span class="p">:</span> <span class="nb">float</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">14</span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">15</span><span class="sd">        Agent-level logic for transitioning from infected to recovered.</span>
<span class="linenos">16</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">17</span>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">health_state</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">recovery_prob</span><span class="p">:</span>
<span class="linenos">18</span>            <span class="bp">self</span><span class="o">.</span><span class="n">health_state</span> <span class="o">=</span> <span class="mi">2</span>
<span class="linenos">19</span>
</pre></div>
</div>
</section>
<section id="data-collector">
<h3>Data Collector<a class="headerlink" href="#data-collector" title="Link to this heading"></a></h3>
<p><em>Identical to the base model.</em> Defined in <code class="docutils literal notranslate"><span class="pre">core/data_collector.py</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">from</span><span class="w"> </span><span class="nn">Melodie</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataCollector</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span>
<span class="linenos"> 4</span><span class="k">class</span><span class="w"> </span><span class="nc">CovidDataCollector</span><span class="p">(</span><span class="n">DataCollector</span><span class="p">):</span>
<span class="linenos"> 5</span>    <span class="k">def</span><span class="w"> </span><span class="nf">setup</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 6</span><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 7</span><span class="sd">        Registers which properties of agents and the environment should be recorded.</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="sd">        In this minimal example we record:</span>
<span class="linenos">10</span><span class="sd">        - micro-level results: each agent&#39;s ``health_state``;</span>
<span class="linenos">11</span><span class="sd">        - macro-level results: population counts on the environment</span>
<span class="linenos">12</span><span class="sd">          (``num_susceptible``, ``num_infected``, ``num_recovered``).</span>
<span class="linenos">13</span><span class="sd">        &quot;&quot;&quot;</span>
<span class="linenos">14</span>        <span class="bp">self</span><span class="o">.</span><span class="n">add_agent_property</span><span class="p">(</span><span class="s2">&quot;agents&quot;</span><span class="p">,</span> <span class="s2">&quot;health_state&quot;</span><span class="p">)</span>
<span class="linenos">15</span>        <span class="bp">self</span><span class="o">.</span><span class="n">add_environment_property</span><span class="p">(</span><span class="s2">&quot;num_susceptible&quot;</span><span class="p">)</span>
<span class="linenos">16</span>        <span class="bp">self</span><span class="o">.</span><span class="n">add_environment_property</span><span class="p">(</span><span class="s2">&quot;num_infected&quot;</span><span class="p">)</span>
<span class="linenos">17</span>        <span class="bp">self</span><span class="o">.</span><span class="n">add_environment_property</span><span class="p">(</span><span class="s2">&quot;num_recovered&quot;</span><span class="p">)</span>
<span class="linenos">18</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="covid_contagion_network.html" class="btn btn-neutral float-left" title="CovidContagionNetwork" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="rock_paper_scissors_trainer.html" class="btn btn-neutral float-right" title="RockPaperScissorsTrainer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2022, ABM4ALL.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>